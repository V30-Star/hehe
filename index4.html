<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Page 4 ‚Äî Sliding Love Puzzle (4x4)</title>
    <style>
      :root {
        --bg: #0b0e16;
        --ink: #eaf0ff;
        --muted: #9aa6bf;
        --card: #131a34;
        --border: #263056;
      }
      body {
        margin: 0;
        color: var(--ink);
        font: 16px/1.6 Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
        background: var(--bg);
        padding: 20px;
      }
      .wrap {
        max-width: 900px;
        margin: auto;
        text-align: center;
        position: relative;
      }
      h1 {
        margin: 0;
        font-size: clamp(22px, 3.4vw, 36px);
      }
      .subtitle {
        color: var(--muted);
        margin-bottom: 16px;
      }

      .board {
        --n: 4;
        --img: url("./asset/love.jpg");
        display: grid;
        grid-template-columns: repeat(var(--n), 1fr);
        width: min(90vw, 480px);
        aspect-ratio: 1;
        margin: auto;
        border: 2px solid #263056;
        border-radius: 12px;
        overflow: hidden;
        background: #0f1530;
      }
      .tile {
        background-image: var(--img);
        background-size: calc(var(--n) * 100%) calc(var(--n) * 100%);
        background-repeat: no-repeat;
        border: 0;
        cursor: pointer;
        transition: filter 0.15s ease;
      }
      .tile:hover {
        filter: brightness(1.06);
      }
      .empty {
        background: none;
        cursor: default;
      }

      .btn {
        margin: 12px 4px;
        padding: 10px 16px;
        border-radius: 10px;
        border: 1px solid #2a3355;
        background: #16204a;
        color: #cfe0ff;
        cursor: pointer;
      }
      .btn:hover {
        transform: translateY(-1px);
      }
      .btn.solve {
        background: #1b8a57;
        border-color: #1b8a57;
        color: #fff;
      }

      .overlay {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        justify-content: center;
        align-items: center;
        color: #c5ffd9;
        flex-direction: column;
        font-size: 20px;
        backdrop-filter: blur(4px);
      }
      .overlay.show {
        display: flex;
      }
      .next {
        margin-top: 14px;
        padding: 10px 14px;
        border-radius: 10px;
        background: #1b8a57;
        border: 1px solid #1a4a2f;
        color: #fff;
        text-decoration: none;
      }

      /* modal password */
      .modal {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        justify-content: center;
        align-items: center;
        z-index: 20;
      }
      .modal.show {
        display: flex;
      }
      .modal-box {
        background: #131a34;
        border: 1px solid #2a3355;
        border-radius: 12px;
        padding: 20px;
        max-width: 300px;
        text-align: center;
      }
      .modal input {
        width: 100%;
        padding: 8px 10px;
        margin-top: 8px;
        border-radius: 6px;
        border: 1px solid #2a3355;
        background: #0f1530;
        color: #eaf0ff;
        text-align: center;
      }
      .modal button {
        margin-top: 10px;
        padding: 8px 16px;
        border-radius: 8px;
        border: none;
        background: #1b8a57;
        color: #fff;
        cursor: pointer;
      }
      /* ‚îÄ‚îÄ CLUE SAMAR 1000 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
      .wrap::after {
        content: "1000";
        position: absolute;
        bottom: 20px;
        right: 40px;
        font-weight: 800;
        font-size: clamp(32px, 8vw, 160px);
        color: #86e0ff;
        opacity: 0.05;
        mix-blend-mode: screen;
        pointer-events: none;
        z-index: 1;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <h1>Page 4</h1>
      <div class="subtitle">Geser ubin sampai gambar cinta lengkap üíï</div>

      <div class="board" id="board" style="--n: 4; --img: url('./asset/love.jpg')"></div>

      <div>
        <button id="shuffle" class="btn">Acak</button>
        <button id="reset" class="btn">Reset</button>
        <button id="solve" class="btn solve">Lihat Jawaban ‚ù§Ô∏è</button>
      </div>
      <div id="moves" class="subtitle">Langkah: 0</div>
    </div>

    <div class="overlay" id="overlay">
      üéâ Completed!
      <a href="index5.html" class="next">Next ‚Üí</a>
    </div>

    <!-- Modal password -->
    <div class="modal" id="passwordModal">
      <div class="modal-box">
        <div>Masukkan tanggal jadian kita (DD-MM-YYYY)</div>
        <input type="text" id="passwordInput" />
        <button id="submitPassword">OK</button>
      </div>
    </div>

    <script>
      const GRID = 4;
      const board = document.getElementById("board");
      const movesEl = document.getElementById("moves");
      const overlay = document.getElementById("overlay");
      const modal = document.getElementById("passwordModal");
      const pwInput = document.getElementById("passwordInput");
      const pwSubmit = document.getElementById("submitPassword");

      let tiles = [],
        emptyIndex,
        moves = 0,
        initialTiles = null;

      function init() {
        board.style.setProperty("--n", GRID);
        const total = GRID * GRID;
        tiles = Array.from({ length: total }, (_, i) => i);
        tiles[total - 1] = null;
        doRandomWalkShuffle(150);
        initialTiles = tiles.slice();
        render();
      }

      function render() {
        board.innerHTML = "";
        tiles.forEach((val, i) => {
          const b = document.createElement("button");
          b.className = "tile";
          if (val === null) {
            b.classList.add("empty");
            emptyIndex = i;
          } else {
            const r = Math.floor(val / GRID),
              c = val % GRID;
            b.style.backgroundPosition = `${(c / (GRID - 1)) * 100}% ${(r / (GRID - 1)) * 100}%`;
            b.addEventListener("click", () => tryMove(i));
          }
          board.appendChild(b);
        });
        movesEl.textContent = "Langkah: " + moves;
      }

      function isAdjacent(i, empty) {
        const sameRow = Math.floor(i / GRID) === Math.floor(empty / GRID);
        if (i === empty - 1 && sameRow) return true;
        if (i === empty + 1 && sameRow) return true;
        if (i === empty - GRID) return true;
        if (i === empty + GRID) return true;
        return false;
      }
      function tryMove(i) {
        if (!isAdjacent(i, emptyIndex)) return;
        [tiles[i], tiles[emptyIndex]] = [tiles[emptyIndex], tiles[i]];
        emptyIndex = i;
        moves++;
        render();
        if (isSolved()) overlay.classList.add("show");
      }
      function isSolved() {
        for (let i = 0; i < tiles.length - 1; i++) {
          if (tiles[i] !== i) return false;
        }
        return tiles[tiles.length - 1] === null;
      }
      function doRandomWalkShuffle(steps = 150) {
        const total = GRID * GRID;
        tiles = Array.from({ length: total }, (_, i) => i);
        tiles[total - 1] = null;
        emptyIndex = total - 1;
        for (let s = 0; s < steps; s++) {
          const nb = [];
          const row = Math.floor(emptyIndex / GRID),
            col = emptyIndex % GRID;
          if (col > 0) nb.push(emptyIndex - 1);
          if (col < GRID - 1) nb.push(emptyIndex + 1);
          if (row > 0) nb.push(emptyIndex - GRID);
          if (row < GRID - 1) nb.push(emptyIndex + GRID);
          const pick = nb[Math.floor(Math.random() * nb.length)];
          [tiles[pick], tiles[emptyIndex]] = [tiles[emptyIndex], tiles[pick]];
          emptyIndex = pick;
        }
        moves = 0;
      }

      document.getElementById("shuffle").onclick = () => {
        doRandomWalkShuffle(150);
        overlay.classList.remove("show");
        moves = 0;
        render();
      };
      document.getElementById("reset").onclick = () => {
        tiles = initialTiles.slice();
        overlay.classList.remove("show");
        moves = 0;
        render();
      };

      // tombol lihat jawaban -> buka modal
      document.getElementById("solve").onclick = () => {
        modal.classList.add("show");
        pwInput.focus();
      };

      // validasi password
      pwSubmit.onclick = () => {
        const val = pwInput.value.trim();
        if (val === "17-06-2025") {
          modal.classList.remove("show");
          solvePuzzle();
        } else {
          pwInput.style.borderColor = "#e74c3c";
          pwInput.value = "";
          pwInput.placeholder = "‚ùå Salah, coba lagi!";
        }
      };

      function solvePuzzle() {
        const total = GRID * GRID;
        tiles = Array.from({ length: total }, (_, i) => i);
        tiles[total - 1] = null;
        emptyIndex = total - 1;
        render();
        overlay.classList.add("show");
      }

      init();
    </script>
  </body>
</html>
